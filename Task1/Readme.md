### <a name="_b7urdng99y53"></a>**Название задачи:** Выбор архитектуры MVP для мониторинга скота
### <a name="_hjk0fkfyohdk"></a>**Автор:** Швецов Александр
### <a name="_uanumrh8zrui"></a>**Дата:** 01.10.2025
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

| **№** | **Действующие лица или системы** | **Use Case** | **Описание** |
| :---: | :------------------------------- | :----------- | :----------- |
| 1 |   Дежурный оператор, Агент на ферме   | Получение оповещения о беспокойном поведении или драке                                              | 1. Камеры фиксируют движение/поведение скота в реальном времени. <br> 2. Нейросеть анализирует видео (детекция драки/задавливания).<br>3. При событии: локальное оповещение (SMS/сирена) отправляется оператору (<5 сек).<br> 4. Видео/данные кэшируются локально.|
|2| Зоотехник, Центральный сервер | Оценка состояния животных и прогноз запасов | 1. Синхронизация данных с агентов (до 10 мин).<br>2. Сервер анализирует видео/датчики (болезнь, поголовье).<br>3. Генерируется отчёт/уведомление в мобильное/веб-приложение.<br>4. Прогноз расхода корма на основе метрик.|
|3| Директор, API-клиент | Управление ролями и метриками | 1. Аутентификация через OAuth/JWT.<br>2. Доступ к дашборду (роли: просмотр/редактирование).<br>3. Передача базовых метрик в legacy-системы (Kafka).<br>4. Добавление кастомных метрик. |

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
Опишите здесь нефункциональные требования и архитектурно значимые требования.

| **№** | **Требование**                                                                                                     |
| :---: | :----------------------------------------------------------------------------------------------------------------- |
|   1   | Отказоустойчивость: 99.95% доступность системы (локальные агенты с кэшем для оффлайн).                             |
|   2   | Производительность: Оповещения <5 сек от события; видеоаналитика в реальном времени (мс); синхронизация до 10 мин. |
|   3   | Расширяемость: Новый функционал без изменений существующего (микросервисы, API для метрик).                        |
|   4   | Безопасность: Современная аутентификация (OAuth/JWT), ролевый доступ.                                              |
|   5   | Масштабируемость: Неограниченное число агентов/ферм.                                                               |
### <a name="_qmphm5d6rvi3"></a>**Решение**

#### **Основное решение**

Это децентрализованная архитектура с центральным сервером и edge-агентами на фермах. Основные компоненты:
- **MVP платформа**: Центральный сервер для аналитики, метрик и API,
- **Агенты на фермах**: Edge-устройства для сбора видео/датчиков, локальной обработки (оффлайн-кэш),
- **Интеграции**: Передача метрик в Kafka, оповещение PUSH и SMS, API для мобильного/Web интерфейсов.


![Основная диаграмма](./main/Архитектура_АгроТех_Системы_v4.png)

#### **Альтернатива**

Гибридная архитектура с локальным сервером на ферме для первичной обработки и облачный hub для хранения и глубокого анализа данных. Основные компоненты: 
-  **MVP платформа**: Центральный сервер для координации,
-  **Локальный сервер на ферме**: Edge для первичной обработки и передачи данных,
-  **Облачное сервис**: Хранение данных и глубокий анализ,
-  **Интеграции**: Передача метрик в Kafka, синхронизация данных по WiFi оповещение PUSH и SMS, API для мобильного/Web интерфейсов.


![Альтернативная диаграмма](./other/Архитектура_АгроТех_Системы_v4.png)

Для начало предпологал, что будет строиться по принципу **cloud-first, on-prem-later**, но есть интернет ограничения в которые упирается вермы. Хотя у данного подхода есть плюсы: 
- быстрый и дешёвый старт для MVP,
- гибкость на начальном этапе,
- хорошая маштабируемость.
  
Но также есть недостатки: 
- зависимость от интернета,
- безопасность (конфиденциальные данные хроняться в облаке),
- при большом росте ферм в дальнейдем будет большая стоимость предоставляемых улуг.
  
По этому было принято решение сделать локальные сервера и взять облачные за альтернативу.

### <a name="_bjrr7veeh80c"></a>**Сравнения**
#### **Системы**

| **Системы**                | **Преимущества**                                                                                                                                                                                                                              | **Недостатки**                                                                                                                                                                                             |
| -------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Оснавная система**       | - Высокая отказоустойчивость:<br>  - Локальные агенты<br>  - LoRaWAN как альтернатива WiFi<br>- Реал-тайм видео<br>- Поддержка неограниченного числа агентов<br>- Безопасность (данные хроняться у себя)<br>- Дальнейшие перспективы выгоднее | - Гибкость и сложность масштабирования<br>- Вся ответственность за безопасность и аварийные ситуации лежит на компании<br>- Высокие первоначальные расходы                                                 |
| **Альтернативное решение** | Масштабируемость на облачных инфраструктурах<br>- Интеграция с существующими CRM/ERP<br>- Низкие затраты на развертывание (без локального железа)                                                                                             | - Зависимости от интернет соединения<br>- Безопасность и конфиденциальност (размещение своих данных у сторонних лиц)<br>- Непредсказуемые затраты на облако<br>- Для размещений в облаке нужны специалисты |

#### **Облочные решения**
| **Облока**           | **Преимущества**                                                                                                                                                                                        | **Недостатки**                                        |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------- |
| Yandex Cloud         | - Широкий спект услуг (Yandex Vision для видеоаналитики скота)<br>- посекундная тарификация для гибкости<br> - Собственные дата центры в России<br> - Интеграция с Kafka<br>- Грант 10 000 RUB на старт | - Цены выше на хранении.                              |
| VK cloud             | - Ориентация на корпоративный сегмент и гибридные решения<br>- Сильный Big Data (для прогноза запасов)<br>- гибридные решения (локальный + облако)                                                      | - Меньшая гибкость для малого бизнеса<br>- Нет гранта |
| Selectel             | - Акцент на производительности (GPU для нейросетей)<br>- DevOps-инструменты для миграции на on-prem                                                                                                     | - Нет AI аналитики                                    |
| SberCloud (cloud.ru) | - Глубокая интеграция с экосистемой Сбера (безопасность для данных)<br>- ФСТЭК-сертификаты<br> - Бесплатная виртуалка - Есть IA аналитика данных                                                        |                                                       |